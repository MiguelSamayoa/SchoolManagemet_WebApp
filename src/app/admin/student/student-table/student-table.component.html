<dialog [id]="modalId" class="modal">
  <div class="modal-box">
    <h3 class="text-lg font-bold">¿Seguro?</h3>
    <p class="py-4">¿Está seguro que desea eliminar al estudiante {{studentToDelete?.firstName}} {{studentToDelete?.lastName}}?</p>
    <div class="modal-action">
      <form method="dialog">
        <!-- Botón para cancelar y cerrar el modal -->
        <button class="btn btn-neutral m-2 p-2" (click)="closeModal()">
          Cancelar
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 p-0">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
          </svg>
        </button>

        <!-- Botón para eliminar el estudiante -->
        <button (click)="delete()" class="btn btn-error text-base-100 m-2 p-2">
          Eliminar
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5 p-0 m-0">
            <path fill-rule="evenodd" d="M16.5 4.478v.227a48.816 48.816 0 0 1 3.878.512.75.75 0 1 1-.256 1.478l-.209-.035-1.005 13.07a3 3 0 0 1-2.991 2.77H8.084a3 3 0 0 1-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 0 1-.256-1.478A48.567 48.567 0 0 1 7.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 0 1 3.369 0c1.603.051 2.815 1.387 2.815 2.951Zm-6.136-1.452a51.196 51.196 0 0 1 3.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 0 0-6 0v-.113c0-.794.609-1.428 1.364-1.452Zm-.355 5.945a.75.75 0 1 0-1.5.058l.347 9a.75.75 0 1 0 1.499-.058l-.346-9Zm5.48.058a.75.75 0 1 0-1.498-.058l-.347 9a.75.75 0 0 0 1.5.058l.345-9Z" clip-rule="evenodd" />
          </svg>
        </button>
      </form>
    </div>
  </div>
</dialog>

<student-formulario
[isOpen]="StudentModal"
[isCreate]="true"
(modalClose)="handleStudentClose()"
(SendStudent)="handleStudentCreate($event)">
</student-formulario>


<ng-container *ngIf="studentToReassign" >
  <reasignacion-create
  [isOpen]="reassingModal"
  (modalClose)="closeReassignModal()"
  (Created)="createAssingStudent($event)"
  [studentId]="studentToReassign.studentId"
  ></reasignacion-create>
</ng-container>

<ng-container >
  <reasignacion-all
    [isOpen]="reassingAllModal"
    [Students]= "estudiantesActivos()"
    (modalClose)="closeReassignAllModal()"
    (Created)="reassignAllStudent($event)"
    [gradeId]="gradeId"
  > </reasignacion-all>
</ng-container>


<div class="navbar shadow bg-base-100">
  <div class="flex-1">
    <a class="btn btn-ghost text-xl">Alumnos</a>
    <i>{{estudiantesActivos().length}} alumnos registrados</i>
  </div>
  <button *ngIf="canCreate == true" class="btn btn-primary text-base-100 " (click)="openReassignAllModal()">Finalizar Ciclo</button>
  <button *ngIf="canCreate == true" class="btn btn-success mx-5 text-base-100 " (click)="openStudentEdit()">Agregar Alumno</button>
</div>

<table class="table">

  <thead>
    <tr>
      <th>Alumno</th>
      <th>Email</th>
      <th class="hidden sm:table-cell">Direccion</th>
      <th class="hidden md:table-cell text-center">Genero</th>
      <th>Acción</th>
    </tr>
  </thead>

  <tbody>
    <tr *ngFor="let student of estudiantesActivos(); let i = index" >
      <td (click)="navigateToStudent(student.studentId)">{{student.firstName}} {{student.lastName}}</td>
      <td (click)="navigateToStudent(student.studentId)">{{student.email}}</td>
      <td (click)="navigateToStudent(student.studentId)" class="hidden sm:table-cell">{{student.address}}</td>
      <td (click)="navigateToStudent(student.studentId)" class="hidden md:table-cell text-center">{{student.gender}}</td>
      <td>
        <button *ngIf="canReassign == true" class="badge badge-primary text-base-100 m-1 p-1 text-sm h-8" (click)="openReassignModal( student )">Reasignar</button>

        <button class="badge badge-error text-base-100 m-1 py-1 px-3 h-8" (click)="openModal(student)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-4 p-0 m-0">
            <path fill-rule="evenodd" d="M16.5 4.478v.227a48.816 48.816 0 0 1 3.878.512.75.75 0 1 1-.256 1.478l-.209-.035-1.005 13.07a3 3 0 0 1-2.991 2.77H8.084a3 3 0 0 1-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 0 1-.256-1.478A48.567 48.567 0 0 1 7.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 0 1 3.369 0c1.603.051 2.815 1.387 2.815 2.951Zm-6.136-1.452a51.196 51.196 0 0 1 3.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 0 0-6 0v-.113c0-.794.609-1.428 1.364-1.452Zm-.355 5.945a.75.75 0 1 0-1.5.058l.347 9a.75.75 0 1 0 1.499-.058l-.346-9Zm5.48.058a.75.75 0 1 0-1.498-.058l-.347 9a.75.75 0 0 0 1.5.058l.345-9Z" />
          </svg>
        </button>
      </td>
    </tr>

    <ng-container *ngIf=" viewUnactives ">
      <tr *ngIf="(estudiantesInactivos().length > 0)">
        <td colspan="5"> <div class="divider divider-neutral w-2/3 text-base mx-auto text-center"> Estudiantes Inactivos </div></td>
      </tr>

      <tr *ngFor="let student of estudiantesInactivos(); let i = index" class="bg-base-300">
        <td (click)="navigateToStudent(student.studentId)" class="opacity-50">{{student.firstName}} {{student.lastName}}</td>
        <td (click)="navigateToStudent(student.studentId)" class="opacity-50">{{student.email}}</td>
        <td (click)="navigateToStudent(student.studentId)" class="hidden sm:table-cell opacity-50">{{student.address}}</td>
        <td (click)="navigateToStudent(student.studentId)" class="hidden md:table-cell opacity-50 text-center">{{student.gender}}</td>
        <td>
          <button *ngIf="canReassign == true" class="badge badge-primary text-base-100 m-1 p-1 text-sm h-8" (click)="openReassignModal( student )">Reasignar</button>

          <button class="badge badge-base-100 m-1 py-1 px-3 h-8" (click)="reincorporar(student.studentId)">Reincorporar</button>
        </td>
      </tr>
    </ng-container>

  </tbody>
</table>

